webpackJsonp([1],{D2mU:function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s("7+uW"),i=s("8f98"),n=s.n(i);const a=(()=>{const e=navigator.userAgent.toLowerCase();return e.indexOf("chrome")>-1?"google-chrome":e.indexOf("safari")>-1?"safari":"general"})();var o={name:"VirtualStream",props:{items:{type:Array,required:!0},reversed:{type:Boolean,default:!1},itemsPerChunk:{type:Number,default:50},maxChunkPreload:{type:Number,default:1},preloadOffset:{type:Number,default:50}},data:()=>({currentChunk:0}),computed:{chunkItems(){let e=0,t=0;const s=[];for(let r=0;r<this.items.length;r++)s[e]||(s[e]=[]),s[e].push(this.items[r]),++t>=this.itemsPerChunk&&(e++,t=0);return s},chunkCount(){return Math.ceil(this.items.length/this.itemsPerChunk)-1}},methods:{handleScroll(){const e="safari"===a?this.$refs.wrapper.scrollTop+this.$refs.wrapper.scrollHeight-this.$refs.wrapper.offsetHeight:this.$refs.wrapper.scrollTop,t=this.getPrevScrollOffset(e),s=this.getNextScrollOffset(e);t&&t>this.preloadOffset&&(this.currentChunk--,window.requestAnimationFrame(()=>{this.correctScrollPosition(!1)})),s&&s>this.preloadOffset&&(this.currentChunk++,window.requestAnimationFrame(()=>{this.correctScrollPosition(!0)}))},getPrevScrollOffset(e){if(this.$refs.itemsPrev){const t=this.$refs.itemsCurrent.offsetHeight+(this.$refs.itemsNext?this.$refs.itemsNext.offsetHeight:0),s=this.$refs.itemsPrev.offsetHeight,r=e+this.$refs.wrapper.offsetHeight-t;return r>=0?r/s*100:0}return!1},getNextScrollOffset(e){if(this.$refs.itemsNext){const t=this.$refs.itemsNext.offsetHeight;return e<=t?100-e/t*100:0}return!1},correctScrollPosition(e){e?this.correctTopScrollPosition():this.correctBottomScrollPosition()},correctTopScrollPosition(){const e=this.$refs.wrapper.offsetHeight,t=this.getOffsetter(),s=this.$refs.itemsNext?this.$refs.itemsNext.offsetHeight:0,r="safari"===a?-1*(s+t-e):s+t;this.$refs.wrapper.scrollTop=r},correctBottomScrollPosition(){this.$refs.wrapper.offsetHeight;const e=this.getOffsetter(),t="safari"===a?(this.$refs.itemsPrev?this.$refs.itemsPrev.offsetHeight:0)+this.$refs.itemsCurrent.offsetHeight:(this.$refs.itemsNext?this.$refs.itemsNext.offsetHeight:0)+this.$refs.itemsCurrent.offsetHeight,s="safari"===a?-1*(t-e):t-e;this.$refs.wrapper.scrollTop=s},getOffsetter(e){return this.$refs.itemsCurrent.offsetHeight*(this.preloadOffset/100)}}},u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"container",staticClass:"VirtualStream__Scroller"},[s("div",{ref:"wrapper",staticClass:"VirtualStream__Wrapper",class:{"VirtualStream__Wrapper--isReversed":e.reversed},on:{scroll:e.handleScroll}},[e.chunkItems[e.currentChunk-1]?s("div",{ref:"itemsPrev",staticClass:"VirtualStream__Items VirtualStream__Items--isPrev"},[e._l(e.chunkItems[e.currentChunk-1],function(t,s){return e._t("default",null,{item:t,index:s})})],2):e._e(),e._v(" "),s("div",{ref:"itemsCurrent",staticClass:"VirtualStream__Items VirtualStream__Items--isCurrent"},[e._l(e.chunkItems[e.currentChunk],function(t,s){return e._t("default",null,{item:t,index:s})})],2),e._v(" "),e.chunkItems[e.currentChunk+1]?s("div",{ref:"itemsNext",staticClass:"VirtualStream__Items VirtualStream__Items--isNext"},[e._l(e.chunkItems[e.currentChunk+1],function(t,s){return e._t("default",null,{item:t,index:s})})],2):e._e()])])},staticRenderFns:[]};var l={name:"App",components:{VirtualStream:s("VU/8")(o,u,!1,function(e){s("rgeZ")},"data-v-e4546226",null).exports},data(){return{items:this.generateMessages(500),itemsPerChunk:8,debug:!1,stream:!1}},methods:{generateMessages(e){const t=[];for(let s=0;s<e;s++)t.push(this.generateMessage(s));return t.reverse()},generateMessage:e=>({id:e,message:n()({sentenceLowerBound:5,sentenceUpperBound:100})}),addMessage(){this.items.splice(0,0,this.generateMessage(this.items.length))},toggleDebug(){this.debug=!this.debug},updateItemsPerChunk(e){this.itemsPerChunk=Number(e.currentTarget.value)}},mounted(){this.stream=this.$refs.stream}},f={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app",class:{"app--isDebugging":e.debug},attrs:{id:"app"}},[s("div",{staticClass:"container"},[s("div",{staticClass:"container-inner"},[s("virtual-stream",{ref:"stream",attrs:{items:e.items,reversed:"","items-per-chunk":e.itemsPerChunk,preloadOffset:80},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.item;return t.index,[s("div",{staticClass:"item"},[s("div",{staticClass:"message"},[e._v(e._s(r.message))])])]}}])})],1),e._v(" "),s("div",{staticClass:"toolbar"},[s("div",[s("button",{on:{click:e.addMessage}},[e._v("Add message")]),e._v(" "),s("div",[s("label",[e._v("\n            Items per Chunk\n            "),s("input",{attrs:{type:"number",min:"8",max:"100"},domProps:{value:e.itemsPerChunk},on:{change:e.updateItemsPerChunk}})])])]),e._v(" "),s("label",[e._v("\n        Enable debugging view\n        "),s("input",{attrs:{type:"checkbox"},domProps:{checked:e.debug},on:{click:e.toggleDebug}})]),e._v(" "),e.debug?s("div",[e._v("\n        Current Chunk: "+e._s(e.stream.currentChunk)),s("br"),e._v("\n        Chunk Count: "+e._s(e.stream.chunkCount)),s("br")]):e._e()])])])},staticRenderFns:[]};var c=s("VU/8")(l,f,!1,function(e){s("NtiA"),s("D2mU")},"data-v-26fed259",null).exports;r.a.config.productionTip=!1,new r.a({el:"#app",components:{App:c},template:"<App/>"})},NtiA:function(e,t){},rgeZ:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.3d50cfe338a8b7e43c18.js.map